<!doctype html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout.html}">
<head><title>Agent List</title></head>
<body>

<section layout:fragment="content">
    <div class="row">
        <div class="col">
            <div th:switch="${agents}">
                <div class="table-responsive">
                    <div class="table table-striped">
                        <h2 th:case="null">No agents, yet...</h2>
                        <div th:case="*">
                            <h2>Agents</h2>
                            <table class="table table-striped table-sm">
                                <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Version</th>
                                    <th>last seen</th>
                                    <th>Network</th>
                                    <th>Test agent</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="agent : ${agents}">
                                    <th th:text="${agent.id}"></th>
                                    <td th:text="${agent.software_version}"></td>
                                    <td th:text="${agent.last_seen}"></td>
                                    <td>
                                        <div class="col-auto">
                                            <span th:class="'bi '+${agent.bi_wifi_icon}+' bi-lg'" th:text="${agent.ap}"></span>
                                            <b>
                                                <span th:text="${agent.failed_pings}" class="text-black"></span>/
                                                <span th:text="${agent.reconnects}" class="text-danger">></span>
                                            </b>

                                        </div>
                                    </td>
                                    <td>
                                        <div class="col-auto">
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'wht','pattern':'medium'});">
                                                <i class="bi bi-lightbulb-fill text-secondary bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'red','pattern':'medium'});">
                                                <i class="bi bi-lightbulb-fill  text-danger bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'ylw','pattern':'medium'});">
                                                <i class="bi bi-lightbulb-fill text-warning bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'grn','pattern':'medium'});">
                                                <i class="bi bi-lightbulb-fill text-success bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'blu','pattern':'medium'});">
                                                <i class="bi bi-lightbulb-fill text-primary bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'buzzer','pattern':'medium'});">
                                                <i class="bi bi-phone-vibrate-fill text-black bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir1','pattern':'medium'});">
                                                <i class="bi bi-volume-up text-info bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir2','pattern':'medium'});">
                                                <i class="bi bi-volume-up text-success bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir3','pattern':'medium'});">
                                                <i class="bi bi-volume-up text-secondary bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir4','pattern':'medium'});">
                                                <i class="bi bi-volume-up text-primary bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir1','pattern':'game_starts'});">
                                                <i class="bi bi-megaphone-fill text-success bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'sir1','pattern':'game_ends'});">
                                                <i class="bi bi-megaphone-fill text-danger bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'play','pattern':''});">
                                                <i class="bi bi-play-circle-fill text-success bi-lg"></i></a>
                                            <a href="#"
                                               th:onclick="post_rest('system/test_agent', {'agentid':[[${agent.id}]],'deviceid':'stop','pattern':''});">
                                                <i class="bi bi-stop-circle-fill text-danger bi-lg"></i></a>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <button title="Sleep" type="button" class="btn btn-secondary btn-circle btn-lg"><i
                    class="bi bi-moon-stars-fill bi-lg" onclick="post_rest('system/powersave_agents')"></i></button>
            <button title="Wake up" type="button" class="btn btn-warning btn-circle btn-lg"><i
                    class="bi bi-sun-fill bi-lg" onclick="post_rest('system/welcome_agents')"></i></button>
        </div>
    </div>
</section>

</body>
</html>
